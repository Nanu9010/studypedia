{% extends 'base.html' %}

{% block title %}Admin Dashboard{% endblock %}
<!-- adminapp/templates/adminapp/dashboard.html -->

{% block content %}
  <div class="container">
    <h1>Admin Dashboard</h1>
    {% if messages %}
      <div class="messages">
        {% for message in messages %}
          <div class="message {{ message.tags }}">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}
    <div class="grid grid-3">
      <div class="card">

      <div class="card">
        <h3>Universities</h3>
        <p><strong>Count:</strong> {{ universities_count }}</p>
        <a href="{% url 'university:university_list' %}" class="btn btn-primary">Manage Universities</a>
      </div>
      <div class="card">
        <h3>Degrees</h3>
        <p><strong>Count:</strong> {{ degrees_count }}</p>
        <a href="{% url 'university:degree_list' %}" class="btn btn-primary">Manage Degrees</a>
      </div>
      <div class="card">
        <h3>Branches</h3>
        <p><strong>Count:</strong> {{ branches_count }}</p>
        <a href="{% url 'university:branch_list' %}" class="btn btn-primary">Manage Branches</a>
      </div>

      <div class="card">
        <h3>Papers</h3>
        <p><strong>Count:</strong> {{ papers_count }}</p>
        <a href="{% url 'papers:paper_list' %}" class="btn btn-primary">Manage Papers</a>
      </div>
      <div class="card">
        <h3>Notes</h3>
        <p><strong>Count:</strong> {{ notes_count }}</p>
        <a href="{% url 'notes:note_list' %}" class="btn btn-primary">Manage Notes</a>
      </div>
      <div class="card">
        <h3>Roadmaps</h3>
        <p><strong>Count:</strong> {{ roadmaps_count }}</p>
        <a href="{% url 'roadmaps:roadmap_list' %}" class="btn btn-primary">Manage Roadmaps</a>
      </div>
      <div class="card">
        <h3>Syllabi</h3>
        <p><strong>Count:</strong> {{ syllabi_count }}</p>
        <a href="{% url 'roadmaps:syllabus_list' %}" class="btn btn-primary">Manage Syllabi</a>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <h2>ðŸš€ Quick Actions</h2>
        <div class="quick-actions-grid">
            <a href="{% url 'papers:paper_create' %}" class="btn btn-primary">Add Paper</a>
            <a href="{% url 'notes:note_create' %}" class="btn btn-primary">Add Note</a>
            <a href="{% url 'roadmaps:syllabus_create' %}" class="btn btn-success">Add Syllabus</a>
            <a href="{% url 'university:university_create' %}" class="btn btn-info">Add University</a>

        </div>
    </div>

    <!-- Recent Activity -->
    <div class="recent-activity">
        <h2>ðŸ“ˆ Recent Activity</h2>
        <div class="admin-sections-grid">
            <div>
                <h3>Recent Papers</h3>
                {% for paper in recent_papers %}
                <div style="background:#fff; padding:0.5rem; border-radius:6px; margin-bottom:0.5rem;">
                    <strong>{{ paper.subject.name }} - {{ paper.get_exam_type_display }}</strong><br>
                    <small>{{ paper.created_at|timesince }} ago</small>
                </div>
                {% empty %}
                <p>No recent papers.</p>
                {% endfor %}
            </div>
            <div>
                <h3>Recent Notes</h3>
                {% for note in recent_notes %}
                <div style="background:#fff; padding:0.5rem; border-radius:6px; margin-bottom:0.5rem;">
                    <strong>{{ note.subject.name }} - {{ note.get_exam_type_display }}</strong><br>
                    <small>{{ note.created_at|timesince }} ago</small>
                </div>
                {% empty %}
                <p>No recent notes.</p>
                {% endfor %}
            </div>
            <div>
                <h3>Recent Orders</h3>
                {% for order in recent_orders %}
                <div style="background:#fff; padding:0.5rem; border-radius:6px; margin-bottom:0.5rem;">
                    <strong>Order #{{ order.id|slice:":8" }}</strong><br>
                    <small>â‚¹{{ order.total_amount }} - {{ order.user.username }} - {{ order.status }}</small>
                </div>
                {% empty %}
                <p>No recent orders.</p>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Users Overview -->
    <div class="user-list">
        <h2>ðŸ‘¥ Users Overview</h2>
        <table>
            <thead>
                <tr>
                    <th>User</th>
                    <th>Email</th>
                    <th>Papers Bought</th>
                    <th>Notes Bought</th>
                    <th>Total Spent</th>
                </tr>
            </thead>
            <tbody>
                {% for u in users_stats %}
                <tr>
                    <td>{{ u.user.username }}</td>
                    <td>{{ u.user.email }}</td>
                    <td>{{ u.papers_bought }}</td>
                    <td>{{ u.notes_bought }}</td>
                    <td>â‚¹{{ u.total_spent }}</td>
                </tr>
                {% empty %}
                <tr><td colspan="5">No users found.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}


